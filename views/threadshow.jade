extends layout
block content
  script.
    function showScoreBJCP(newValue){
      document.getElementById("scoreBJCP").innerHTML=newValue;
    }
    function showScore(newValue){
      document.getElementById("score").innerHTML=newValue;
    }

  if (public=='pregen')
    section#main
      div(class="inner")
        header
          h2 æœ¬æ¨™ç±¤å°šæœªå¡«å¯«å…§å®¹
        p é»æ­¤åˆ—å°æ¨™ç±¤ï¼Š
          a(target="_blank" href="/thread/#{_id}/printA4QRCode") A4ç´”æ¢ç¢¼
        p éºå¤±ç®¡ç†æ¨™ç±¤ï¼Ÿ è«‹
          a(target="_blank" href="https://www.facebook.com/profile.php?id=100005461480349") ç™¼å€‹è¨Šæ¯çµ¦æˆ‘
  else
    section#main
      div(class="inner")
        header
          h2= title
        div(style="border-width:3px;border-style:dashed;border-color:#FFAC55;padding:5px;min-height:190px;")
          img(src="#{qrcode}", style="width:175px; float:left;")
          span(style="display:inline; white-space: pre-line; word-break: break-all; width:400px;")
            b= title
            br
            i #{style} by #{nickname}, #{created_at}
            br
            span= ownerSaid
        p(style="clear:left") å¹³å‡è©•åˆ†ï¼š#{avgScore} BJCPå¹³å‡ï¼š#{avgScoreBJCP}
          br
          | Tagsï¼š#{tags}
        if (typeof(recipe) != 'undefined' && recipe!=null)
          div(class="field")
            label(for="recipe") è¨­è¨ˆ/é…’è­œ
            textarea(name="recipe" rows="6") #{recipe} 
        if (typeof(image_url) != 'undefined' && image_url!=null)
          p
            a(href="#{image_url}")
              img(src="#{image_url}", style="max-width:800px;max-height:600px;width:100%")

    section#comment
      div(class="inner")
        header
          h3 ç•™ä¸‹ä½ çš„æ„Ÿæƒ³
        form(action='/thread/#{_id}/comment', method="post")
          div(style="border-width:2px;border-style:solid;border-color:#FFAC55;padding:5px;margin:3px;").input
            div(class="field half first")
              label(for="nickname") æš±ç¨±
              input(type="text" name="nickname" id="nickname")
            div(class="field half")
              label(for="email") è¯çµ¡æ–¹å¼ï¼ˆé¸å¡«ï¼‰
              input(type="text" name="email" id="email")
            div(class="field half first")
              label(for="scoreBJCP") BJCPè©•é‡ï¼ˆé¸å¡«ï¼‰
              input(type="range", name="scoreBJCP", min="-1", max="50", value="-1", onchange="showScoreBJCP(this.value)", )
              span(id="scoreBJCP") ğŸ±(-1ä¸è¨ˆå…¥è©•åˆ†)
            div(class="field half") 
              label(for="score") ç¸½é«”è©•é‡ï¼ˆ0-100ï¼‰
              input(type="range", name="score", min="0", max="100", value="80", onchange="showScore(this.value)")
              span(id="score") 80
            div(class="field")
              label(for="response") æƒ³æ³•èˆ‡åé¥‹
              textarea(name="response" rows="6") #{defaultResponse}
            div(class="field")
              label(for="bjcppass") BJCPè©•å¯©ä»£ç¢¼ï¼ˆé¸å¡«ï¼Œè‹¥æ‚¨æœ‰BJCPèº«ä»½ä¸”é¡˜æ„æä¾›å°ˆæ¥­è©•é‡ï¼Œè«‹èˆ‡æˆ‘å€‘è¯ç¹«ï¼‰
              input(type="password", name="bjcppass")
            ul(class="actions")
              li
                input(type="submit" value="â†’é€å‡º" class="alt")

    if (typeof(comments) != 'undefined' && comments!=null)
      section#comments
        div(class="inner")
          header
            h3 å·²ç¶“æŠ•ç¨¿çš„å›è¦†
          for com in comments
            if (typeof(com.bjcppass) != 'undefined' && com.bjcppass!=null)
              div(style="border-width:2px;border-style:solid;border-color:#FFD700;padding:5px;margin:3px;").comment
                p è©•å¯©è¬›è©• #{com.bjcppass}
                  br
                  if (typeof(com.email) != 'undefined' && com.email!="")
                    a(href="mailto:#{com.email}") #{com.nickname}
                  else
                    | #{com.nickname}
                  | ï¼šScore #{com.score}
                  if (com.scoreBJCP!=-1)
                    | / BJCP #{com.scoreBJCP}
                p
                  pre= com.response
          for com in comments
            if (typeof(com.bjcppass) == 'undefined' || com.bjcppass==null || com.bjcppass=='')
              div(style="border-width:2px;border-style:solid;border-color:#000000;padding:5px;margin:3px;").comment
                p  #{com.bjcppass}
                  if (typeof(com.email) != 'undefined' && com.email!="")
                    a(href="mailto:#{com.email}") #{com.nickname}
                  else
                    | #{com.nickname}
                  | ï¼šScore #{com.score}
                  if (com.scoreBJCP!=-1)
                    | / BJCP #{com.scoreBJCP}
                if (typeof(com.response) != 'undefined' && com.response!="")
                  p
                    pre= com.response
